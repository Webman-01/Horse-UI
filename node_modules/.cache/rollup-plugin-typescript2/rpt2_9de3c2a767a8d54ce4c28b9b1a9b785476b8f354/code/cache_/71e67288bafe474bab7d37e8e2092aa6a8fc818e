{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent as _defineComponent } from 'vue';\nimport { renderSlot as _renderSlot, normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, withCtx as _withCtx, createVNode as _createVNode, createCommentVNode as _createCommentVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, vShow as _vShow, withDirectives as _withDirectives, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"progress-text\" };\nimport { computed, ref, watch } from \"vue\";\nimport { updateEmits, uploadProps, } from \"./upload\";\nimport UploadContent from \"./upload-content.vue\";\nimport { createNameSpace } from \"../../../utils/create\";\nimport HIcon from \"../../../components/icon\";\nimport { CloseOutline, CheckmarkCircleOutline } from \"@vicons/ionicons5\";\nexport default _defineComponent(Object.assign({\n    name: \"h-upload\",\n}, { __name: 'upload', props: uploadProps, emits: updateEmits, setup(__props, { emit: __emit }) {\n        const bem = createNameSpace(\"upload\");\n        const props = __props;\n        const emit = __emit;\n        const uploadFiles = ref(props.FileList);\n        watch(uploadFiles, (newVal) => {\n            emit(\"onUpdate:file-list\", newVal);\n        });\n        const findFile = (rawFile) => {\n            return uploadFiles.value.find((file) => file.uid === rawFile.uid);\n        };\n        const uploadContentProps = computed(() => (Object.assign(Object.assign({}, props), { onStart: (rawFile) => {\n                console.log(\"start\");\n                const uploadFile = {\n                    uid: rawFile.uid,\n                    name: rawFile.name,\n                    percentage: 0,\n                    raw: rawFile,\n                    size: rawFile.size,\n                    status: \"start\",\n                };\n                uploadFile.url = URL.createObjectURL(rawFile);\n                uploadFiles.value = [...uploadFiles.value, uploadFile];\n                props.onChange(uploadFile);\n            }, onProgress: (file, rawFile) => {\n                console.log(\"progress\");\n                const uploadFile = findFile(rawFile);\n                console.log(uploadFiles.value, \"000\");\n                uploadFile.status = \"uploading\";\n                uploadFile.percentage = file.percentage;\n                props.onProgress(file, uploadFile, uploadFiles.value);\n            }, onRemove: (rawFile) => __awaiter(this, void 0, void 0, function* () {\n                console.log(\"remove\");\n                const uploadFile = findFile(rawFile);\n                const result = yield props.beforeRemove(uploadFile, uploadFiles.value);\n                if (result) {\n                    const fileList = uploadFiles.value;\n                    fileList.splice(fileList.indexOf(uploadFile), 1);\n                    props.onRemove(uploadFile, uploadFiles.value);\n                }\n            }), onError: (error, rawFile) => {\n                console.log(\"err\");\n                const uploadFile = findFile(rawFile);\n                uploadFile.status = \"error\";\n                const fileList = uploadFiles.value;\n                fileList.splice(fileList.indexOf(uploadFile), 1);\n                props.onError(error, uploadFile, fileList);\n            }, onSuccess: (res, rawFile) => {\n                console.log(\"success\");\n                const uploadFile = findFile(rawFile);\n                uploadFile.status = \"success\";\n                const fileList = uploadFiles.value;\n                props.onSuccess(res, uploadFile, fileList);\n            } })));\n        const deleteFile = (index) => {\n            uploadFiles.value.splice(index, 1);\n            emit(\"onUpdate:file-list\", uploadFiles);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(_Fragment, null, [\n                _createVNode(UploadContent, _normalizeProps(_guardReactiveProps(uploadContentProps.value)), {\n                    default: _withCtx(() => [\n                        _renderSlot(_ctx.$slots, \"default\")\n                    ]),\n                    _: 3\n                }, 16),\n                _createCommentVNode(\" {{ uploadFiles }} \"),\n                _createCommentVNode(\" 展示的文件列表 \"),\n                _withDirectives(_createElementVNode(\"div\", {\n                    class: _normalizeClass(_unref(bem).b('list'))\n                }, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(uploadFiles.value, (item, index) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            class: _normalizeClass(_unref(bem).be('list', 'item')),\n                            key: index\n                        }, [\n                            _createElementVNode(\"div\", {\n                                class: _normalizeClass(_unref(bem).be('list', 'item-name'))\n                            }, _toDisplayString(item.name), 3),\n                            _createCommentVNode(\" show check \"),\n                            _createElementVNode(\"div\", {\n                                class: _normalizeClass(_unref(bem).be('list', 'item-label'))\n                            }, [\n                                _withDirectives(_createVNode(_unref(HIcon), { size: 20 }, {\n                                    default: _withCtx(() => [\n                                        _createVNode(_unref(CheckmarkCircleOutline))\n                                    ]),\n                                    _: 2\n                                }, 1536), [\n                                    [_vShow, item.percentage === 100]\n                                ])\n                            ], 2),\n                            _createCommentVNode(\" show close \"),\n                            _createElementVNode(\"div\", {\n                                class: _normalizeClass(_unref(bem).be('list', 'item-label-hover'))\n                            }, [\n                                _createVNode(_unref(HIcon), {\n                                    onClick: ($event) => (deleteFile(index)),\n                                    size: 20\n                                }, {\n                                    default: _withCtx(() => [\n                                        _createVNode(_unref(CloseOutline))\n                                    ]),\n                                    _: 2\n                                }, 1032, [\"onClick\"])\n                            ], 2),\n                            _createCommentVNode(\" 进度条 \"),\n                            _withDirectives(_createElementVNode(\"div\", {\n                                class: _normalizeClass(_unref(bem).b('progress'))\n                            }, [\n                                _createElementVNode(\"div\", {\n                                    class: _normalizeClass(_unref(bem).b('pro1gress-bar')),\n                                    style: _normalizeStyle({ width: item.percentage + '%' })\n                                }, null, 6),\n                                _createElementVNode(\"div\", _hoisted_1, _toDisplayString(Math.floor(item.percentage)) + \"%\", 1)\n                            ], 2), [\n                                [_vShow, item.percentage !== 100]\n                            ])\n                        ], 2));\n                    }), 128))\n                ], 2), [\n                    [_vShow, _ctx.showFileList]\n                ])\n            ], 64));\n        };\n    } }));\n//# sourceMappingURL=upload.vue?vue&type=script&setup=true&lang.js.map","references":["/Users/mamingzhe/Horse UI/node_modules/.pnpm/vue@3.4.21_typescript@5.4.2/node_modules/vue/dist/vue.d.ts","/Users/mamingzhe/Horse UI/node_modules/.pnpm/vue@3.4.21_typescript@5.4.2/node_modules/vue/dist/vue.d.ts","/Users/mamingzhe/Horse UI/node_modules/.pnpm/vue@3.4.21_typescript@5.4.2/node_modules/vue/dist/vue.d.ts","/Users/mamingzhe/Horse UI/packages/components/upload/src/upload.ts","/Users/mamingzhe/Horse UI/packages/components/upload/src/upload-content.ts","/Users/mamingzhe/Horse UI/packages/utils/create.ts","/Users/mamingzhe/Horse UI/packages/components/icon/index.ts","/Users/mamingzhe/Horse UI/node_modules/.pnpm/@vicons+ionicons5@0.12.0/node_modules/@vicons/ionicons5/es/index.d.ts"],"map":"{\"version\":3,\"file\":\"upload.vue?vue&type=script&setup=true&lang.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../packages/components/upload/src/upload.vue?vue&type=script&setup=true&lang.ts\"],\"names\":[],\"mappings\":\"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\"}"}
